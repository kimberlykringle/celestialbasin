<html>
	<head>
		<meta charset="utf-8">
		<style type="text/css">
			#mainTable {
				position: absolute;
				margin: 0;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				font: 40px arial;
				color: white;
				text-align: center;
				background: rgba(0,0,0,0.5);
				width: 100%;
			}

			#affiliation {
				position: absolute;
				margin: 0;
				top: 95%;
				left: 50%;
				transform: translate(-50%, 0);
				color: white;
				text-align: center;
				font: 11px arial;
				background: rgba(0,0,0,0.5);
				width: 100%;
			}

			#rowOne {
				line-height: 100px;
			}

			#rowTwo {
				font: 16px arial;
			}
		</style>
	</head>

	<body background="background.jpg">
		<p id="timer">
			<table id="mainTable">
				<tr>
					<td id="rowOne">Made for the Master Hong server.</td>
				</tr>
				<tr>
					<td id="rowTwo">Last Synced: 6:25 PM (May 31, 2017) MST</td>
				</tr>
			</table>
		</p>
		<p id="notice">
			<table id="affiliation">
				<tr>
					<td>Brought to you by the Lightish Reds.<br>This website relies on your local computer time. Please insure your computer time is set correctly.<br>This site is not affiliated with Blade & Soul, NCSoft, NCWest, or any other NCSoft subsidiaries.</td>
				</tr>
			</table>
		</p>
	</body>

	<script>
		setInterval(tracker, 1000);

		function tracker() {
			var rowOne = document.getElementById("rowOne");
			//var rowTwo = document.getElementById("rowTwo");
			//Seed date
			var seedDate = new Date("June 1, 2017 17:46:23");
			//Current date
			var currentDate = calcTime(18);
			//Minutes since seed date
			var minutesSince = Math.floor(((currentDate - seedDate) / 1000) / 60);
			//How many boss intervals have surpassed since seed date
			var counter = Math.floor(minutesSince / 43) + 1;
			//Amount of seconds that have passed since seed date
			var currentTime = Math.floor((currentDate - seedDate) / 1000);
			//How many seconds need to pass before the next boss will spawn
			var nextBossTime = ((counter * 43) * 60);
			var minutes = Math.floor((nextBossTime - currentTime) / 60);
			var seconds = Math.floor((nextBossTime - currentTime) % 60);
			var rawTime = ((minutes * 60) + seconds);

			if (rawTime >= 2400) {
				minutes -= 40;
				var finalTime = minutes + ":";
				finalTime += (seconds < 10) ? ("0" + seconds) : seconds;
				//document.getElementById("timer").innerHTML = "Spawns In: <b>" + finalTime + "</b>";
				rowOne.innerHTML = "Spawns In: <b>" + finalTime + "</b>";
			}
			else if (rawTime >= 1800 && rawTime < 2400) {
				minutes -= 30;
				var finalTime = minutes + ":";
				finalTime += (seconds < 10) ? ("0" + seconds) : seconds;
				//document.getElementById("timer").innerHTML = "Ends In: <b>" + finalTime + "</b>";
				rowOne.innerHTML = "Ends In: <b>" + finalTime + "</b>";
			}
			else {
				var finalTime = minutes + ":";
				finalTime += (seconds < 10) ? ("0" + seconds) : seconds;
				//document.getElementById("timer").innerHTML = "Announcement In: <b>" + finalTime + "</b>";
				rowOne.innerHTML = "Announcement In: <b>" + finalTime + "</b>";
			}

			/*switch(counter % 3) {
				case 0:
					rowTwo.innerHTML = "<br><strike>Location: " + ((rawTime >= 1800) ? "Croxar" : "Aomak");
					break;
				case 1:
					rowTwo.innerHTML = "<br><strike>Location: " + ((rawTime >= 1800) ? "Aomak" : "Excavation");
					break;
				case 2:
					rowTwo.innerHTML = "<br><strike>Location: " + ((rawTime >= 1800) ? "Excavation" : "Croxar");
					break;
			}
			rowTwo += "</strike>";*/
		}

		function getTime() {
			var url = "https://maps.googleapis.com/maps/api/timezone/json?location=53.5444,113.4909&timestamp=1495767912000&key=AIzaSyBpprMVR41ITaH7jJqXdr1Cwwo50ylHL9Q";
			var xml = new XMLHttpRequest();
			xml.open('GET', url, true);
			xml.responseType = 'json';
			xml.onload = function() {
				var status = xml.status;
				(status == 200) ? callback(null, xml.response) : callback(status);
			}
		}

		function calcTime(offset) {
		    var d = new Date();
		    var utc = d.getTime() + (d.getTimezoneOffset() * 60000);
		    var nd = new Date(utc + (3600000*offset));
		    nd.setDate(nd.getDate()-1);
		    return nd;
		}
	</script>
</html>
